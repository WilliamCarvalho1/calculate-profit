<div class="container mt-4">
  <div class="row align-items-start">
    <div class="col-md-4">
      <div class="card p-3">
        <h5>Shipment Id</h5>
        <form [formGroup]="searchForm" (ngSubmit)="searchShipment()" class="w-100">
          <mat-form-field appearance="outline" class="w-100">
            <mat-label>Shipment Id</mat-label>
            <input matInput formControlName="shipmentId" placeholder="Enter Shipment Id"/>
          </mat-form-field>
          <div class="d-flex justify-content-end mt-2">
            <button mat-raised-button color="primary" type="submit">Search</button>
          </div>
        </form>
      </div>
    </div>

    <div class="col-md-8">
      <div class="card p-3">
        <h5>Income & Outcome</h5>
        <form [formGroup]="calculationForm" (ngSubmit)="calculateProfit()">
          <div class="row mb-2">
            <div class="col">
              <mat-form-field appearance="outline" class="w-100">
                <mat-label>Income</mat-label>
                <input matInput formControlName="income" type="text"/>
              </mat-form-field>
            </div>
            <div class="col">
              <mat-form-field appearance="outline" class="w-100">
                <mat-label>Cost</mat-label>
                <input matInput formControlName="cost" type="text"/>
              </mat-form-field>
            </div>
            <div class="col">
              <mat-form-field appearance="outline" class="w-100">
                <mat-label>Additional Cost</mat-label>
                <input matInput formControlName="additionalCost" type="text"/>
              </mat-form-field>
            </div>
          </div>
          <div class="d-flex justify-content-end">
            <button mat-raised-button color="primary" type="submit">Calculate</button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <div class="row mt-4">
    <div class="col-12">
      @if (shipmentData && shipmentData.cargos && shipmentData.cargos.length > 0) {
        <table class="table table-striped table-bordered">
          <thead>
          <tr>
            <th>Income</th>
            <th>Total Cost</th>
            <th>Profit or Loss</th>
            <th class="text-end">Delete Cargo</th>
          </tr>
          </thead>
          <tbody>
            @for (cargo of shipmentData.cargos; track cargo.id; let $index = $index) {
              <tr>
                <td>{{ cargo.income }}</td>
                <td>{{ cargo.totalCost }}</td>
                <td>{{ cargo.profit }}</td>
                <td class="text-end">
                  <button
                    mat-icon-button
                    color="warn"
                    type="button"
                    (click)="deleteCargo(cargo.id)"
                    aria-label="Delete cargo"
                  >
                    <span class="material-icons" style="font-size: 18px;">close</span>
                  </button>
                </td>
              </tr>
            }
          </tbody>
        </table>
      }
    </div>
  </div>
</div>
